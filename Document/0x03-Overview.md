# OWASP モバイルセキュリティテストガイドの序文

OWASP モバイルセキュリティテストガイド (MSTG) は Android や iOS デバイスのセキュリティテストに特に焦点を当てた OWASP テストプロジェクトの拡張版です。

このプロジェクトの目標は Android や iOS デバイスでのアプリケーションのテストの対象、理由、時期、場所、方法を人々が理解できるようにすることです。このプロジェクトは OWASP Mobile Top 10, モバイルアプリセキュリティチェックリスト、モバイルアプリケーションセキュリティ検証標準 (MASVS) に対処するために設計された完全な一連のテストケースを提供します。

## モバイルアプリケーションテストガイドが必要な理由

新しいテクノロジはすべて新しいセキュリティリスクをもたらします。モバイルコンピューティングも変わりません。iOS や Android などの最新のモバイルオペレーティングシステムは従来のデスクトップオペレーティングシステムと比較して、設計上より安全であると言えますが、モバイルアプリ開発プロセスの中でセキュリティが考慮されていない場合には悪い方向に向かいことが多くあります。データストレージ、アプリ間通信、暗号 API の適切な使用方法、セキュアなネットワーク通信は慎重に検討する必要がある側面のほんの一部です。

モバイルアプリ領域におけるセキュリティの問題は従来のデスクトップとはいくつかの重要な点で異なります。まず第一に、デスクトップタワーをポケットに入れて持ち歩くことを望んでいる人はほとんどいませんが、モバイルデバイスでこれを行うことはより一般的です。その結果、モバイルデバイスの紛失や盗難が起こりやすくなるため、攻撃者はデバイスに物理的にアクセスして、格納しているデータにアクセスする可能性が高くなります。

## モバイルアプリセキュリティの主要な領域

多くのモバイルアプリ侵入テスト担当者はネットワークやウェブアプリのペネトレーションテストの経験を持ち、その知識の多くがモバイルアプリテストに役立ちます。実際にはすべてのモバイルアプリは何らかのバックエンドサービスと対話しており、これらのサービスは私たちが皆知っている同じ種類の攻撃を受けやすいものです。しかし、モバイルアプリ側には、インジェクション攻撃や同様の攻撃に対する攻撃領域はほとんどありません。ここでは、主にデバイス自体とネットワークの双方でのデータ保護に焦点を当てています。以下はモバイルアプリセキュリティにおける主要な領域の一部です。

### ローカルデータストレージ

ユーザー資格情報や個人情報などの機密データを保護することはモバイルセキュリティの重要な焦点です。まず第一に、IPC などのオペレーティングシステムメカニズムが不適切に使用されている場合、機密データは同じデバイス上で実行されている他のアプリに意図せずさらされる可能性があります。また、データはクラウドストレージ、バックアップ、キーボードキャッシュに意図せずリークする可能性もあります。さらに、モバイルデバイスは他の種類のデバイスに比べて紛失や盗難の可能性が高くなるため、物理的なアクセスを得る攻撃者はより可能性の高いシナリオとなります。

モバイルアプリの観点からは、適切なキーストレージ API を使用したり、利用可能な場合はハードウェア支援のセキュリティ機能を利用するなど、ユーザーデータを格納する際にこの特別な注意が必要です。

特に Android では、断片化の問題に対処する必要があります。すべての Android がハードウェア支援のセキュアなストレージを提供するわけではありません。さらに、多くのデバイスでは古いバージョンの API を搭載した時代遅れのバージョンの Android が動いています。これらのバージョンをサポートするには、アプリは重要なセキュリティ機能が不足している可能性のある古いバージョンの API に制限する必要があります。選択がより良いセキュリティと潜在的なユーザーベースの多数の締め出しとの間で行われる場合、勝算はより良いセキュリティのほうが有利です。

### 信頼できるエンドポイントとの通信

モバイルデバイスは一般的にさまざまなネットワークに接続します。それには他の (おそらく悪意のある) クライアントと共有される公衆 WiFi ネットワークもあります。これはネットワークベースの攻撃の大きな機会を生み出します。簡単なパケットスニッフィングから不正なアクセスポイントの作成や SSL 中間者攻撃 (またはルーティングプロトコルの注入など古いものであっても、悪いやつは気にしません) に至ります。

モバイルアプリとリモートサービスエンドポイントの間で交換される情報の機密性と完全性を維持することは重要です。最低限、モバイルアプリは適切な設定で TLS プロトコルを使用して、ネットワーク通信にセキュアで暗号化されたチャネルを設定する必要があります。

### 認証と認可

ほとんどの場合、リモートサービスへのユーザーログインはモバイルアプリのアーキテクチャ全体の不可欠な要素です。ほとんどの認証と認可のロジックはエンドポイントで行われますが、モバイルアプリ側での実装上の課題もいくつかあります。ウェブアプリとは対照的に、モバイルアプリでは指紋スキャンなどのユーザーとデバイス間の認証機能によりアンロックされるセッショントークンを長時間格納することがよくあります。これによりユーザーエクスペリエンスは向上します (アプリを起動するたびに複雑なパスワードを入力することが好きな人はいません) が、さらに複雑性も増し、具体的な実装には多くのエラーを生む可能性があります。

モバイルアプリアーキテクチャでは OAuth2 などの認証フレームワークの導入、別のサービスへの認証の委譲、認証プロバイダへの認証プロセスの委託も増えています。OAuth2 を使用すると、クライアント側の認証ロジックを同じデバイスの他のアプリ (システムブラウザなど) に「アウトソース」できます。セキュリティテスト担当者はさまざまな可能なアーキテクチャの長所と短所を知る必要があります。

### モバイルプラットフォームとの相互作用

このグループ内のコントロールはアプリがプラットフォーム API や標準コンポーネントをセキュアな方法で使用していることを保証します。さらに、コントロールはアプリ間の通信 (IPC) をカバーします。

### コード品質とエクスプロイトの軽減

「古典的な」インジェクションやメモリ管理の問題はモバイルアプリ側ではあまり関係ありません。これは主に必要な攻撃領域がないためです。ほとんどの場合、モバイルアプリは信頼できるバックエンドサーバーと UI のみインタフェースをとるため、アプリに大量のバッファオーバーフロー脆弱性が存在する場合でも、これらの脆弱性は一般的に有効な攻撃方法をありません。ウェブの世界では非常に一般的な XSS などのブラウザエクスプロイトについても同じことが言えます。もちろん、常に例外はあり、XSS は理論的には場合によって可能ですが、XSS の問題を実際に利用することは非常に稀です。

しかし、これは開発者がいい加減なコードを書くことを見逃すべきであることを意味するものではありません。セキュリティのベストプラクティスに従うと、改竄に対して耐性のある堅牢なリリースビルドとなります。コンパイラやモバイル SDK により提供される「フリー」のセキュリティ機能はセキュリティを強化し攻撃を軽減するのに役立ちます。

### 改竄防止とリバース防止

There is three things you should never bring up in date conversations: Religion, politics and code obfuscation. Many security experts dismiss client-side protections outright. However, the fast is that software protection controls are widely used in the mobile app world, so security testers need ways to deal with them. We also think that there is *some* benefit to be had, as long as the protections are employed with a clear purpose and realistic expectations in mind, and aren't used to *replace* security controls.

## OWASP モバイルアプリセキュリティ検証標準、チェックリスト、テストガイド

このガイドは3つの密接に関連するモバイルアプリケーションセキュリティドキュメントのセットに属しています。3つのドキュメントはすべて同じセキュリティ要件の基本セットにマップします。状況に応じて、さまざまな目的を達成するために、単体で使用することも組み合わせて使用することもできます。

* **モバイルアプリケーションセキュリティ検証標準 (MASVS):** モバイルアプリのセキュリティモデルを定義し、モバイルアプリの一般的なセキュリティ要件を示す標準。これはアーキテクト、開発者、テスト担当者、セキュリティ専門家、消費者がセキュアなモバイルアプリケーションとは何であるかを定義するために使用できます。
* **モバイルセキュリティテストガイド (MSTG):** モバイルアプリのセキュリティをテストするためのマニュアル。オペレーティングシステム特有のベストプラクティス(現時点では Android および iOS 向け)とともに MASVS で定義されている要件の検証手順を提供します。MSTG はモバイルアプリのセキュリティテストの完全性と一貫性を保証します。また、モバイルアプリケーションセキュリティテスト担当者の単体の学習リソースやリファレンスガイドとしても役立ちます。
* **モバイルアプリセキュリティチェックリスト:** 実際の評価の中で MASVS に対するコンプライアンスを追跡するためのチェックリスト。このリストは各要件の MSTG テストケースに都合よくリンクしており、モバイルペネトレーションアプリテストを簡単に行うことができます。

![Document Overview](Images/Chapters/0x03/owasp-mobile-overview.jpg)

例えば、MASVS 要件は計画およびアーキテクチャ設計の段階で使用され、チェックリストやテストガイドは手動セキュリティテストのベースラインとして、もしくは開発後の自動セキュリティテストのテンプレートとして使用できます。次の章では、モバイルアプリケーションのペネトレーションテストの中でチェックリストやガイドを実際にどのように適用できるかについて説明します。

## モバイルセキュリティテストガイドの構成

MASVS で指定されているすべての要件はテストガイドに技術的な詳細を記述されています。MSTG の主要なセクションについてこの章で簡単に説明します。

このガイドは以下のように構成されています。

- テストプロセスと技法のセクションでは、モバイルアプリのセキュリティテスト手法、脆弱性解析技法、SDLC におけるセキュリティテスト、脆弱性解析技法を紹介します。

- Android テストガイドには、セキュリティ入門、セキュリティテストケース、リバースエンジニアリングと改竄の技法と対策など、Android プラットフォームに固有のすべてが含まれています。

- iOS テストガイドには、iOS オペレーティングシステムの概要、セキュリティテスト、リバースエンジニアリングとリバース防止など、iOS に固有のすべてが含まれています。

- 付録では、認証とセッション管理、ネットワーク通信、暗号化などのモバイル OS とは独立して適用される技術的なテストケースについて説明します。また、ソフトウェア保護スキームを評価するための方法論も含んでいます。
