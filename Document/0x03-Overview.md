# モバイルセキュリティテストガイドの序文

技術革新は迅速に起こります。一昔前、スマートフォンは小さいキーボードを持つ魅力のない端末、技術に精通したビジネスユーザーのための高価な玩具でした。今日、スマートフォンは私たちの生活に不可欠なものです。私たちは情報、ナビゲーション、コミュニケーションのためにそれらに頼っています。ビジネスや社会生活の中の至るところにあります。

これらのデバイスで実行されているアプリは、私たちの個人情報、画像、音声、メモ、アカウントデータ、ビジネス情報、位置情報などを格納します。私たちが日常的に使用するサービスに接続するクライアントとして、そして他の人と交換するすべてのメッセージを処理する通信ハブとして動作します。他人のスマートフォンに侵入するとその人の人生にフィルタなしでアクセスできます。モバイルデバイスの紛失や盗難が増えモバイルマルウェアが増加していると考えられ、データ保護の必要性はよりいっそう明らかになっています。

すべての新しいテクノロジーは新しいセキュリティリスクをもたらします。モバイルコンピューティングも同様です。iOS や Android などの最新のモバイルオペレーティングシステムは従来のデスクトップオペレーティングシステムと比較して設計上セキュアであるにもかかわらず、モバイルアプリ開発プロセスでセキュリティが考慮されていない場合、うまくいかないことがまだ多くあります。データストレージ、アプリ間通信、暗号APIの適切な使い方や安全なネットワーク通信は慎重な検討が必要な局面のほんの一部です。

## モバイルアプリケーションの脅威

モバイルアプリ領域におけるセキュリティの問題は従来のデスクトップソフトウェアとはいくつかの重要な点で異なります。まず、デスクトップタワーをポケットに入れて持ち歩くことを望んでいる人はほとんどいませんが、モバイルデバイスでこれを行うことは明らかです。その結果として、モバイルデバイスの紛失や盗難が増え、攻撃者はデバイスに物理的にアクセスし格納されているデータにアクセスする可能性が高くなります。また、デバイスを放置すると、攻撃者は一時的に物理的にアクセスでき(悪意あるメイド攻撃)、所有者が気付かないうちにデバイスを完全に侵害したりデータを盗んだりすることができます。

モバイルアプリの観点からは、適切なキーストレージ API を使用したり、利用可能であればハードウェア支援のセキュリティ機能を利用するなど、ユーザーデータを格納する際には細心の注意が必要であることを意味します。しかしここで別の問題が発生します。多くはアプリが実行されているデバイスやオペレーティングシステムおよびその設定によって異なります。キーチェーンはパスコードでロックされていますか？一部の Android デバイスのようにハードウェア支援のセキュアストレージを提供しない場合はどうなりますか？アプリはこれを確認すべきですか、それともそれはユーザーの責任ですか？

モバイルデバイスは他の(おそらく悪意のある)クライアントと共有されている公衆 WiFi ネットワークを含め、さまざまなネットワークに定期的に接続しているという点が、多くの固定された装置との重要な違いです。これは単純なパケット傍受から不正なアクセスポイントの作成や SSL 中間者攻撃まで (もしくはルーティングプロトコルインジェクションなどの古いものであっても、悪意のあるものはどんなものでも使用します) ネットワークベースの攻撃に大きなチャンスをもたらします。

## OWASP Mobile Top 10 2016
OWASP Mobile Top 10 は OWASP Top Ten プロジェクトと同等のものですが、モバイルアプリケーションセキュリティに重点を置いて設計されています。ほとんどの場合、情報セキュリティ業界の人々が "OWASP Top Ten" プロジェクトについて話し合っていますが、実際には Web アプリケーションセキュリティだけを指しています。

このガイドは OWASP Mobile Top 10 2016 と同等の機能を持つモバイルアプリケーションセキュリティに関する重要な文書です。

OWASP Mobile Top 10 は情報セキュリティ業界のさまざまなベンダーやコンサルタントから得られた生のデータに基づいて導出されており、実際のモバイルアプリケーションで最も重要なモバイルアプリケーションセキュリティの欠陥が何であるかについて広く合意しています。

以下が OWASP Mobile Top 10 です。

* M1 - 不適切なプラットフォームの利用 <sup>[1]</sup>
  * モバイルプラットフォーム機能の誤用、またはプラットフォームセキュリティコントロールの不適切な使用
  * カバレッジの範囲には、Android インテント、プラットフォームパーミッション、TouchID の誤用、キーチェーン、またはモバイルオペレーティングシステムの一部であるその他のセキュリティコントロールが含まれます。
  * 一例として、公表されたガイドラインの違反、慣例や一般的な慣行の違反、意図しない誤用があります。
* M2 - 安全でないデータストレージ <sup>[2]</sup>
  * モバイルデバイスにローカルに格納されているユーザーデータやアプリデータに対する不十分な保護メカニズム
  * カバレッジの範囲には、紛失や盗難されたモバイルデバイスを獲得した攻撃者、モバイルデバイス上で実行される攻撃者に代わって動作するマルウェアや再パッケージ化されたアプリが含まれます。
  * 安全性に欠けているデータには、SQLite データベース、ログファイル、XML ファイル、クッキーなどのファイルが含まれます。
* M3 - 安全でない通信 <sup>[3]</sup>
  * モバイルデバイスのキャリアネットワークやインターネット上で転送されるユーザーデータやアプリデータに対する不十分な保護メカニズム
  * カバレッジの範囲には、同一ローカルエリアネットワーク (LAN) を共有する攻撃者、ネットワークデバイス、マルウェア、および証明書ピンニングなどの防御メカニズムがモバイルアプリに実装されているかどうかが含まれます。
* M4 - 安全でない認証 <sup>[4]</sup>
  * 適切な認証方法とコントロールの欠如
  * カバレッジの範囲には脆弱なパスワードポリシーなどの認証脆弱性の悪用が含まれます。
* M5 - 不十分な暗号化 <sup>[5]</sup>
  * 不十分な強度の暗号標準の使用、または脆弱な暗号実装や使用方法
  * カバレッジの範囲には、物理的なアクセスによる不適切に暗号化されたデータのクラッキングや攻撃者に代わって動作するモバイルマルウェアが含まれます。
* M6 - 安全でない認可 <sup>[6]</sup>
  * 適切なロール、パーミッションの検証、アクセス権のコントロールの欠如
  * カバレッジの範囲には安全でない直接オブジェクト参照などの認証脆弱性の悪用が含まれます。
* M7 - 脆弱なコード品質 <sup>[7]</sup>
  * コーディングパターンの不十分な一貫性や適切なユーザーデータ入力検証やメソッド呼び出しの欠如
  * カバレッジの範囲にはモバイルアプリのコード内で行われたメソッドコールに信頼されない入力を渡す可能性のある任意のエンドポイントが含まれます。マルウェアやフィッシング詐欺による悪用の可能性があります。
* M8 - コード改竄 <sup>[8]</sup>
  * アプリコードの完全性チェックを実行する実行時チェック機能の欠如
  * カバレッジの範囲にはサードパーティアプリストアにホストとされている悪意のあるアプリを介するコード改変による悪用が含まれます。悪意のある攻撃者はユーザーを騙してフィッシング攻撃によりアプリをインストールする可能性もあります。
* M9 - リバースエンジニアリング <sup>[9]</sup>
  * 難読化メソッドの欠落
  * カバレッジの範囲には、アプリストアからモバイルアプリをダウンロードし、ローカル環境でさまざまなツールを使用して解析し、潜在的な攻撃経路を特定することが含まれます。
* M10 - 余計な機能 <sup>[10]</sup>
  * 製品ビルドを公開する前のログやエンドポイント検証の欠如
  * カバレッジの範囲には、バックエンドシステムやモバイルアプリ自体の隠し機能や余計な機能の特定、およびエンドユーザーの関与なしに自身のシステムから直接その機能を悪用することが含まれます。

脆弱性のカテゴリおよびモバイルアプリケーションへの侵害を防ぐための手順についての詳細は、OWASP Mobile Top 10 2016 プロジェクトページ <sup>11</sup> を参照ください。

## OWASP モバイルアプリセキュリティ検証標準、チェックリスト、テストガイド

このガイドは3つの密接に関連するモバイルアプリケーションセキュリティドキュメントのセットに属しています。3つのドキュメントはすべて同じセキュリティ要件の基本セットにマップします。状況に応じて、単体で使用することも、さまざまな目的を達成するために組み合わせて使用することもできます。

* **モバイルアプリケーションセキュリティ検証標準 (MASVS):** モバイルアプリのセキュリティモデルを定義し、モバイルアプリの一般的なセキュリティ要件を示す標準。これはアーキテクト、開発者、テスト担当者、セキュリティ専門家、消費者がセキュアなモバイルアプリケーションとは何であるかを定義するために使用できます。
* **モバイルセキュリティテストガイド (MSTG):** モバイルアプリのセキュリティをテストするためのマニュアル。オペレーティングシステム特有のベストプラクティス(現時点では Android および iOS 向け)とともに MASVS で定義されている要件の検証手順を提供します。MSTG はモバイルアプリのセキュリティテストの完全性と一貫性を保証します。また、モバイルアプリケーションセキュリティテスト担当者の単体の学習リソースやリファレンスガイドとしても役立ちます。
* **モバイルアプリセキュリティチェックリスト:** 実際の評価の中で MASVS に対するコンプライアンスを追跡するためのチェックリスト。このリストは各要件の MSTG テストケースに都合よくリンクしており、モバイルペネトレーションアプリテストを簡単に行うことができます。

![Document Overview](Images/Chapters/0x03/owasp-mobile-overview.jpg)

例えば、MASVS 要件は計画およびアーキテクチャ設計の段階で使用され、チェックリストやテストガイドは手動セキュリティテストのベースラインとして、もしくは開発後の自動セキュリティテストのテンプレートとして使用できます。次の章では、モバイルアプリケーションのペネトレーションテストの中でチェックリストやガイドを実際にどのように適用できるかについて説明します。

## モバイルセキュリティテストガイドの構成

MASVS で指定されているすべての要件はテストガイドに技術的な詳細を記述されています。この章では MSTG のメインセクションについて簡単に説明します。

### テストプロセスと技法

このセクションではチェックリストとプロジェクトでそれを使用する方法について説明します。テストケースで使用されるそれぞれの解析技法はソースコードやバイナリの静的解析および動的解析として説明されています。改竄やリバースエンジニアリングの紹介もこのセクションの一部です。

### Android テストガイド

-- TODO
テストガイドの Android の章には Android プラットフォーム上で MASVS の要件を検証するための技術的な手順がすべて記載されています。

### iOS テストガイド

-- TODO
テストガイドの iOS の章には iOS プラットフォーム上で MASVS の要件を検証するための技術的な手順がすべて記載されています。

### リバースエンジニアリングと改竄

-- TODO

### テストツール

効果的にモバイルセキュリティテストを実行するために使用できるさまざまなツールがあり、ツールの選択は好みや予算に依存します。このドキュメントの末尾にある「テストツール」の章に豊富なツールのリストがあります。

-- TODO [Describe the organization of the current guide] --

## 参考情報

* [1] M1 - Improper Platform Usage - https://www.owasp.org/index.php/Mobile_Top_10_2016-M1-Improper_Platform_Usage
* [2] M2 - Insecure Data Storage - https://www.owasp.org/index.php/Mobile_Top_10_2016-M2-Insecure_Data_Storage
* [3] M3 - Insecure Communication - https://www.owasp.org/index.php/Mobile_Top_10_2016-M3-Insecure_Communication
* [4] M4 - Insecure Authentication - https://www.owasp.org/index.php/Mobile_Top_10_2016-M4-Insecure_Authentication
* [5] M5 - Insufficient Cryptography - https://www.owasp.org/index.php/Mobile_Top_10_2016-M5-Insufficient_Cryptography
* [6] M6 - Insecure Authorization - https://www.owasp.org/index.php/Mobile_Top_10_2016-M6-Insecure_Authorization
* [7] M7 - Poor Code Quality - https://www.owasp.org/index.php/Mobile_Top_10_2016-M7-Poor_Code_Quality
* [8] M8 - Code Tampering - https://www.owasp.org/index.php/Mobile_Top_10_2016-M8-Code_Tampering
* [9] M9 - Reverse Engineering - https://www.owasp.org/index.php/Mobile_Top_10_2016-M9-Reverse_Engineering
* [10] M10 - Extraneous Functionality - https://www.owasp.org/index.php/Mobile_Top_10_2016-M10-Extraneous_Functionality
* [11] OWASP Mobile Top 2016 Project Page - https://www.owasp.org/index.php/Mobile_Top_10_2016-Top_10
